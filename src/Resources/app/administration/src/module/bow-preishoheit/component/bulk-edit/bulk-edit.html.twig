{% block bow_preishoheit_bulk_edit %}
    <div class="bow-preishoheit-bulk-edit">
        <sw-card :title="$tc('bow-preishoheit.bulk.cardTitle')">
            <template #toolbar>
                <div class="bulk-edit-actions">
                    <sw-button
                        variant="primary"
                        size="small"
                        :disabled="!selectedItems.length"
                        @click="onBulkEditClick">
                        {{ $tc('bow-preishoheit.bulk.editSelected', selectedItems.length) }}
                    </sw-button>

                    <sw-button
                        variant="ghost"
                        size="small"
                        :disabled="!selectedItems.length"
                        @click="onClearSelection">
                        {{ $tc('bow-preishoheit.bulk.clearSelection') }}
                    </sw-button>
                </div>
            </template>

            <sw-data-grid
                :dataSource="products"
                :columns="columns"
                :showSettings="true"
                :showSelection="true"
                :allowColumnSort="true"
                :isLoading="isLoading"
                :sortBy="sortBy"
                :sortDirection="sortDirection"
                :page="page"
                :limit="limit"
                :total="total"
                @selection-change="onSelectionChange"
                @page-change="onPageChange"
                @sort-change="onSort">

                <template #cell-price="{ item }">
                    {{ item.price | currency }}
                </template>

                <template #cell-preishoheitProduct.surchargePercentage="{ item }">
                    {{ item.preishoheitProduct ? item.preishoheitProduct.surchargePercentage : '0' }}%
                </template>

                <template #empty-state>
                    <sw-empty-state
                        :title="$tc('bow-preishoheit.bulk.emptyStateTitle')"
                        :subtitle="$tc('bow-preishoheit.bulk.emptyStateSubtitle')">
                    </sw-empty-state>
                </template>
            </sw-data-grid>
        </sw-card>

        <sw-modal
            v-if="showBulkEditModal"
            :title="$tc('bow-preishoheit.bulk.modalTitle')"
            @modal-close="onCloseBulkEditModal">

            <div v-if="isSaving" class="bulk-processing-status">
                <sw-progress-bar
                    :value="(processingStatus.processed / processingStatus.total) * 100"
                    :text="$tc('bow-preishoheit.bulk.processingStatus', 0, {
                        processed: processingStatus.processed,
                        total: processingStatus.total,
                        success: processingStatus.success,
                        failed: processingStatus.failed
                    })">
                </sw-progress-bar>
            </div>

            <div v-else class="bulk-edit-form">
                <sw-select-field
                    v-model="bulkEditData.adjustmentType"
                    :label="$tc('bow-preishoheit.bulk.adjustmentType')"
                    :options="adjustmentTypeOptions">
                </sw-select-field>

                <sw-number-field
                    v-model="bulkEditData.value"
                    :label="$tc('bow-preishoheit.bulk.adjustmentValue')"
                    :min="0"
                    :max="100"
                    :digits="2">
                </sw-number-field>
            </div>

            <template #modal-footer>
                <sw-button
                    variant="ghost"
                    size="small"
                    @click="onCloseBulkEditModal">
                    {{ $tc('global.default.cancel') }}
                </sw-button>

                <sw-button-process
                    variant="primary"
                    size="small"
                    :disabled="!isValidBulkEdit"
                    :isLoading="isSaving"
                    @click="onSaveBulkEdit">
                    {{ $tc('bow-preishoheit.bulk.save') }}
                </sw-button-process>
            </template>
        </sw-modal>
    </div>
{% endblock %}
